{"ast":null,"code":"var _jsxFileName = \"/Users/jlc7191/Code/RoadKagaWeb/src/page/Learn2-Message.js\";\nimport React from 'react';\nimport { HashLink as Link } from 'react-router-hash-link';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\nimport { postMSG, putMSG, delMSG, postCMSG, postCMSGAsync, postMSGAsync } from '../action/Learn2MessageAction';\nimport MessageBox from '../components/MessageBox/MessageBox';\nimport AvatarInput from '../components/AvatarInput/AvatarInput';\nimport AvatarInputFeedback from '../components/AvatarInput/AvatarInputFeedback'; //處理input同步\n\nclass Message extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleScroll = event => {\n      let scrollTop = event.srcElement.scrollTop;\n      let gearBox = document.getElementById('gearBox');\n      gearBox.style = \"transform: rotate(\".concat(scrollTop / 5, \"deg);opacity: \").concat(scrollTop * 0.00065);\n    };\n\n    this.ModalhandleShow = messageId => {\n      this.setState({\n        show: true,\n        monderMessageId: messageId\n      });\n    };\n\n    this.ModalhandleClose = () => {\n      this.setState({\n        show: false\n      });\n    };\n\n    this.feedbackClose = () => {\n      this.ModalhandleClose();\n    };\n\n    this.inpNameChange = event => {\n      this.setState({\n        name: event.target.value\n      });\n    };\n\n    this.inpCompanyChange = event => {\n      this.setState({\n        company: event.target.value\n      });\n    };\n\n    this.avatarIconClick = event => {\n      switch (event.target.id) {\n        case 'aIcon1':\n          this.setState({\n            aIcon: {\n              aIcon1Real: true,\n              aIcon2Real: false,\n              aIcon3Real: false,\n              aIcon4Real: false,\n              aIcon5Real: false\n            }\n          });\n          break;\n\n        case 'aIcon2':\n          this.setState({\n            aIcon: {\n              aIcon1Real: false,\n              aIcon2Real: true,\n              aIcon3Real: false,\n              aIcon4Real: false,\n              aIcon5Real: false\n            }\n          });\n          break;\n\n        case 'aIcon3':\n          this.setState({\n            aIcon: {\n              aIcon1Real: false,\n              aIcon2Real: false,\n              aIcon3Real: true,\n              aIcon4Real: false,\n              aIcon5Real: false\n            }\n          });\n          break;\n\n        case 'aIcon4':\n          this.setState({\n            aIcon: {\n              aIcon1Real: false,\n              aIcon2Real: false,\n              aIcon3Real: false,\n              aIcon4Real: true,\n              aIcon5Real: false\n            }\n          });\n          break;\n\n        default:\n          this.setState({\n            aIcon: {\n              aIcon1Real: false,\n              aIcon2Real: false,\n              aIcon3Real: false,\n              aIcon4Real: false,\n              aIcon5Real: true\n            }\n          });\n      }\n    };\n\n    this.ButtonMouseOver = () => {\n      document.querySelector('#messageInputButton').className = 'messageInputButtonOver';\n    };\n\n    this.ButtonMouseOut = () => {\n      document.querySelector('#messageInputButton').className = 'messageInputButtonOut';\n    };\n\n    this.ButtonClick = () => {\n      let messageInput = document.getElementById('messageInput');\n      let name = document.getElementById('inpName').value;\n      let content = document.getElementById('inpContent').value;\n      messageInput.classList.remove('show');\n      const newData = {\n        id: 'msg' + +new Date(),\n        name: name.length !== 0 ? name : '神秘客',\n        company: document.getElementById('inpCompany').value,\n        avatar: '',\n        content: content.length !== 0 ? content : '可能鍵盤壞掉...沒打字',\n        awesome: 0,\n        boo: 0,\n        time: String(+new Date())\n      };\n      let stateAvatar = this.state.aIcon;\n      stateAvatar.aIcon1Real === true ? newData.avatar = 'Beard' : stateAvatar.aIcon2Real === true ? newData.avatar = 'Hair' : stateAvatar.aIcon3Real === true ? newData.avatar = 'Hairstyle' : stateAvatar.aIcon4Real === true ? newData.avatar = 'Hairstyle2' : newData.avatar = 'Moustache';\n      this.props.postMSGAsync(newData);\n      document.getElementById('inpContent').value = '';\n    };\n\n    this.feedbackSave = () => {\n      // 回傳是哪篇留言的id\n      let messageId = this.state.monderMessageId; //做好要蓋回去child的資料\n\n      let newChildData = {\n        id: messageId,\n        cId: 'cMsg' + +new Date(),\n        cName: document.getElementById('cInpName').value,\n        cCompany: document.getElementById('cInpCompany').value,\n        cAvatar: '',\n        // 這個下面再處理\n        cContent: document.getElementById('feedbackContent').value,\n        cAwesome: 0,\n        cBoo: 0,\n        cTime: +new Date() // 處理頭像\n\n      };\n      let stateAvatar = this.state.aIcon;\n      stateAvatar.aIcon1Real === true ? newChildData.cAvatar = 'Beard' : stateAvatar.aIcon2Real === true ? newChildData.cAvatar = 'Hair' : stateAvatar.aIcon3Real === true ? newChildData.cAvatar = 'Hairstyle' : stateAvatar.aIcon4Real === true ? newChildData.cAvatar = 'Hairstyle2' : newChildData.cAvatar = 'Moustache'; // 從redux調出母留言的完整資料\n\n      this.props.postCMSGAsync(newChildData);\n      this.ModalhandleClose();\n    };\n\n    this.mobileButtonClick = () => {\n      let mobileButton = document.getElementById('mobileButton');\n      let messageInput = document.getElementById('messageInput');\n      let textback = document.getElementById('textback');\n      let goback = document.getElementById('goback');\n      mobileButton.classList.toggle('red');\n      messageInput.classList.toggle('show');\n      goback.classList.toggle('show');\n      textback.classList.toggle('hide');\n    };\n\n    this.state = {\n      //本地顯示用 直接寫比較快\n      show: false,\n      name: '',\n      company: '',\n      aIcon: {\n        aIcon1Real: true,\n        aIcon2Real: false,\n        aIcon3Real: false,\n        aIcon4Real: false,\n        aIcon5Real: false\n      },\n      monderMessageId: ''\n    };\n  }\n\n  async componentDidMount() {\n    let messageView = document.getElementById('messageView');\n    messageView.addEventListener('scroll', this.handleScroll); // msg db完成\n\n    const res = await fetch('http://localhost:3003/api/Learn2Info', {\n      method: 'GET',\n      // or 'PUT'\n      headers: new Headers({\n        'Content-Type': 'application/json'\n      })\n    });\n    const data = await res.json();\n    const dbmsg = await data;\n    await dbmsg.map(el => {\n      this.props.postMSG(el);\n      return el;\n    }); //cmsg db完成\n\n    const cres = await fetch('http://localhost:3003/api/Learn2CInfo', {\n      method: 'GET',\n      // or 'PUT'\n      headers: new Headers({\n        'Content-Type': 'application/json'\n      })\n    });\n    const cdata = await cres.json();\n    const dbcmsg = await cdata;\n    await dbcmsg.map(el => {\n      this.props.postCMSG(el);\n      return el;\n    });\n  }\n\n  componentWillUnmount() {\n    let messageView = document.getElementById('messageView');\n    messageView.removeEventListener('scroll', this.handleScroll);\n  }\n\n  render() {\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      id: \"gearBox\",\n      className: \"gearBox\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"gearIcon fas fa-cog\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      id: \"mobileButton\",\n      className: \"mobileButton\",\n      onClick: this.mobileButtonClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      id: \"textback\",\n      className: \"textback\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, \"\\u6211\\u8981\\u7559\\u8A00\"), React.createElement(\"div\", {\n      id: \"goback\",\n      className: \"goback\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-times\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }))), React.createElement(\"main\", {\n      className: \"Learn2Container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"messageView\",\n      className: \"messageView\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, this.props.msgs !== undefined ? this.props.msgs.map(el => React.createElement(MessageBox, {\n      id: el.id,\n      key: el.id,\n      name: el.name,\n      company: el.company,\n      avatar: el.avatar,\n      content: el.content,\n      awesome: el.awesome,\n      boo: el.boo,\n      time: el.time,\n      feedbackClick: this.ModalhandleShow,\n      feedbackClose: this.ModalhandleClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    })) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }, \"\\u73FE\\u5728\\u6C92\\u6709\\u7559\\u8A00\\u554A\\u554A\\u554A\\u554A\\uFF5E\\u5FEB\\u7559\\uFF01\\uFF01\")), React.createElement(\"div\", {\n      id: \"messageInput\",\n      className: \"messageInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      className: \"ff1 fc1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, \"\\u7559\\u8A00\\u7248\"), React.createElement(\"p\", {\n      className: \"ff1 fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, \"\\u6211\\u76F8\\u4FE1\\u7A7A\\u676F\\u662F\\u9032\\u6B65\\u6700\\u91CD\\u8981\\u7684\\u5FC3\\u614B\\u4E4B\\u4E00\\uFF0C\\u6211\\u4E5F\\u6B63\\u52AA\\u529B\\u4FDD\\u6301\\u8457\\uFF0C\\u82E5\\u5C0D\\u9019\\u4E9B\\u4F5C\\u54C1\\u6709\\u4EFB\\u4F55\\u60F3\\u6CD5\\uFF0C\\b\\u8ACB\\u76E1\\u91CF\\u7D66\\u4E88\\u5EFA\\u8B70\\uFF0C\\u5927\\u611F\\u8B1D\\uFF5E\"), React.createElement(\"p\", {\n      className: \"ff1 fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, \"\\u6B64\\u9801\\u70BA\\u5BE6\\u4F5CRedux\\u7684\\u9801\\u9762\\uFF0C\\u6240\\u6709\\u66F4\\u65B0\\u9805\\u76EE\\u7686\\u4E32\\u9023\\u5230Redux\\u7684Store\\u4F86\\u6539\\u8B8A\\u6E32\\u67D3\\uFF0C\\u96D6\\u7136\\u5728\\u8CC7\\u7B56\\u6703\\u7684\\u5927\\u5C08\\u984C\\u4E2D\\u5DF2\\u505A\\u904E\\u7559\\u8A00\\u529F\\u80FD\\uFF0C\\u4F46\\u7576\\u521D\\u6642\\u9593\\u592A\\u8D95\\u6368\\u68C4\\u5F88\\u591A\\u6771\\u897F\\uFF0C\\u56E0\\u6B64\\u9019\\u6B21\\u5E0C\\u671B\\u80FD\\u5BEB\\u51FA\\u66F4\\u5B8C\\u6574\\u6709\\u8DA3\\u7684\\u7559\\u8A00\\u677F\\u3002\"), React.createElement(\"small\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, \"\\u53E6\\u5916\\u70BA\\u4E86\\u6709\\u7121\\u9650\\u7684\\u6B63\\u80FD\\u91CF\\uFF08\\u6216\\u8CA0\\u80FD\\u91CFXD\\uFF09\\u6309\\u8B9A\\u8DDF\\u5653\\u7279\\u5730\\u5BEB\\u6210\\u53EF\\u4EE5\\u7121\\u9650\\u6309\\uFF0C\\u5982\\u679C\\u60F3\\u770B\\u4E00\\u822C\\u4E0D\\u53EF\\u91CD\\u8986\\u6309\\u8B9A\\u7684\\u529F\\u80FD\\uFF0C\\u53EF\\u53BB\\u4F5C\\u54C1\\u9801\\u8CC7\\u7B56\\u6703\\u5927\\u5C08\\u984C\\u88E1\\u6211\\u6709\\u5BEB\\u3002\"), React.createElement(\"label\", {\n      htmlFor: \"inpName\",\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, \"Name\"), React.createElement(\"input\", {\n      id: \"inpName\",\n      placeholder: \"\\u8ACB\\u8F38\\u5165\\u59D3\\u540D\",\n      value: this.state.name,\n      onChange: this.inpNameChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"inpCompany\",\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }, \"\\u516C\\u53F8\\u540D\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      id: \"inpCompany\",\n      placeholder: \"\\u8ACB\\u8F38\\u5165\\u516C\\u53F8\\u540D\",\n      value: this.state.company,\n      onChange: this.inpCompanyChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }), React.createElement(\"small\", {\n      className: \"campanySmallText\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, \"\\u53EF\\u4E0D\\u586B\")), React.createElement(\"label\", {\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    }, \"\\u982D\\u50CF\"), React.createElement(AvatarInput, {\n      state: this.state,\n      avatarIconMouseOver: this.avatarIconMouseOver,\n      avatarIconMouseOut: this.avatarIconMouseOut,\n      avatarIconClick: this.avatarIconClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"inpContent\",\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, \"\\u7559\\u8A00\\u5167\\u5BB9\"), React.createElement(\"textarea\", {\n      id: \"inpContent\",\n      placeholder: \"\\u8ACB\\u8F38\\u5165\\u7559\\u8A00\\u5167\\u5BB9\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }), this.props.msgs[0] !== undefined ? React.createElement(Link, {\n      smooth: true,\n      to: '/message/path#' + 'box' + this.props.msgs[0].id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      id: \"messageInputButton\",\n      className: \"messageInputButtonOut\",\n      onMouseOver: this.ButtonMouseOver,\n      onMouseOut: this.ButtonMouseOut,\n      onClick: this.ButtonClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    }, \"Send\")) : '')), React.createElement(Modal, {\n      size: \"lg\",\n      show: this.state.show,\n      onHide: this.feedbackClose,\n      \"aria-labelledby\": \"contained-modal-title-vcenter\",\n      centered: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, React.createElement(Modal.Header, {\n      closeButton: true,\n      className: \"bg-light border-0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"feebackMessageInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"cInpName\",\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 362\n      },\n      __self: this\n    }, \"Name\"), React.createElement(\"input\", {\n      id: \"cInpName\",\n      placeholder: \"\\u8ACB\\u8F38\\u5165\\u59D3\\u540D\",\n      value: this.state.name,\n      onChange: this.inpNameChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"cInpCompany\",\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, \"\\u516C\\u53F8\\u540D\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      id: \"cInpCompany\",\n      placeholder: \"\\u8ACB\\u8F38\\u5165\\u516C\\u53F8\\u540D\",\n      value: this.state.company,\n      onChange: this.inpCompanyChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375\n      },\n      __self: this\n    }), React.createElement(\"small\", {\n      className: \"campanySmallText\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381\n      },\n      __self: this\n    }, \"\\u53EF\\u4E0D\\u586B\")), React.createElement(\"label\", {\n      className: \"textMarginTop fc3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    }, \"\\u982D\\u50CF\"), React.createElement(AvatarInputFeedback, {\n      state: this.state,\n      avatarIconMouseOver: this.avatarIconMouseOver,\n      avatarIconMouseOut: this.avatarIconMouseOut,\n      avatarIconClick: this.avatarIconClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    }))), React.createElement(Modal.Body, {\n      className: \"bg-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"feebackMessageInput\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"border-bottom border-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      className: \"text-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395\n      },\n      __self: this\n    }, \"\\u56DE\\u8986\\u5167\\u5BB9\")), React.createElement(\"textarea\", {\n      id: \"feedbackContent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397\n      },\n      __self: this\n    }))), React.createElement(Modal.Footer, {\n      className: \"bg-dark border-0 justify-content-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"warning\",\n      onClick: this.feedbackClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401\n      },\n      __self: this\n    }, \"\\u96E2\\u958B\"), React.createElement(Button, {\n      type: \"submit\",\n      variant: \"info\",\n      onClick: this.feedbackSave,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405\n      },\n      __self: this\n    }, \"\\u5132\\u5B58\"))));\n  }\n\n} // 綁定 redux store\n// 綁定 props.msgs <=> store.msgs\n// 我們想要呼叫redux的store可以直接props   前提是先綁定\n// 所以這邊這樣綁就可以直接props.msgs就抓到裡面的資料了\n\n\nconst mapStateToProps = store => ({\n  msgs: store.msgs,\n  cmsgs: store.cmsgs\n}); // 綁定 redux dispatch\n// 你要用這個action就是要dispatch\n// 範例：store.dispatch(postMSGAsync())\n// 這邊是引入多個所以用bindActionCreators包一起\n// 然後引入action要用props所以用mapStateToProps這個\n// 第3種，: redux(state)綁定到此元件的props、部份綁定action creator\n// 這個action creator就是上面引入的那個\n\n\nconst mapDispatchToProps = dispatch => bindActionCreators({\n  postMSG,\n  putMSG,\n  delMSG,\n  postCMSG,\n  postCMSGAsync,\n  postMSGAsync\n}, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Message);","map":{"version":3,"sources":["/Users/jlc7191/Code/RoadKagaWeb/src/page/Learn2-Message.js"],"names":["React","HashLink","Link","connect","bindActionCreators","Modal","Button","postMSG","putMSG","delMSG","postCMSG","postCMSGAsync","postMSGAsync","MessageBox","AvatarInput","AvatarInputFeedback","Message","Component","constructor","props","handleScroll","event","scrollTop","srcElement","gearBox","document","getElementById","style","ModalhandleShow","messageId","setState","show","monderMessageId","ModalhandleClose","feedbackClose","inpNameChange","name","target","value","inpCompanyChange","company","avatarIconClick","id","aIcon","aIcon1Real","aIcon2Real","aIcon3Real","aIcon4Real","aIcon5Real","ButtonMouseOver","querySelector","className","ButtonMouseOut","ButtonClick","messageInput","content","classList","remove","newData","Date","length","avatar","awesome","boo","time","String","stateAvatar","state","feedbackSave","newChildData","cId","cName","cCompany","cAvatar","cContent","cAwesome","cBoo","cTime","mobileButtonClick","mobileButton","textback","goback","toggle","componentDidMount","messageView","addEventListener","res","fetch","method","headers","Headers","data","json","dbmsg","map","el","cres","cdata","dbcmsg","componentWillUnmount","removeEventListener","render","msgs","undefined","avatarIconMouseOver","avatarIconMouseOut","mapStateToProps","store","cmsgs","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { HashLink as Link } from 'react-router-hash-link'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\n\nimport Modal from 'react-bootstrap/Modal'\nimport Button from 'react-bootstrap/Button'\nimport {\n  postMSG,\n  putMSG,\n  delMSG,\n  postCMSG,\n  postCMSGAsync,\n  postMSGAsync,\n} from '../action/Learn2MessageAction'\nimport MessageBox from '../components/MessageBox/MessageBox'\nimport AvatarInput from '../components/AvatarInput/AvatarInput'\nimport AvatarInputFeedback from '../components/AvatarInput/AvatarInputFeedback'\n\n//處理input同步\n\nclass Message extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      //本地顯示用 直接寫比較快\n      show: false,\n      name: '',\n      company: '',\n      aIcon: {\n        aIcon1Real: true,\n        aIcon2Real: false,\n        aIcon3Real: false,\n        aIcon4Real: false,\n        aIcon5Real: false,\n      },\n      monderMessageId: '',\n    }\n  }\n\n  async componentDidMount() {\n    let messageView = document.getElementById('messageView')\n    messageView.addEventListener('scroll', this.handleScroll)\n\n    // msg db完成\n    const res = await fetch('http://localhost:3003/api/Learn2Info', {\n      method: 'GET', // or 'PUT'\n      headers: new Headers({\n        'Content-Type': 'application/json',\n      }),\n    })\n    const data = await res.json()\n    const dbmsg = await data\n    await dbmsg.map(el => {\n      this.props.postMSG(el)\n      return el\n    })\n\n    //cmsg db完成\n    const cres = await fetch('http://localhost:3003/api/Learn2CInfo', {\n      method: 'GET', // or 'PUT'\n      headers: new Headers({\n        'Content-Type': 'application/json',\n      }),\n    })\n    const cdata = await cres.json()\n    const dbcmsg = await cdata\n    await dbcmsg.map(el => {\n      this.props.postCMSG(el)\n      return el\n    })\n  }\n  componentWillUnmount() {\n    let messageView = document.getElementById('messageView')\n    messageView.removeEventListener('scroll', this.handleScroll)\n  }\n  handleScroll = event => {\n    let scrollTop = event.srcElement.scrollTop\n    let gearBox = document.getElementById('gearBox')\n    gearBox.style = `transform: rotate(${scrollTop /\n      5}deg);opacity: ${scrollTop * 0.00065}`\n  }\n  // 顯示區-----------------------------------------\n  // Modal掛件的顯示function no-db\n  ModalhandleShow = messageId => {\n    this.setState({ show: true, monderMessageId: messageId })\n  }\n  ModalhandleClose = () => {\n    this.setState({ show: false })\n  }\n  // no-db\n  feedbackClose = () => {\n    this.ModalhandleClose()\n  }\n\n  // 輸入區-----------------------------------------\n  // no-db\n  inpNameChange = event => {\n    this.setState({ name: event.target.value })\n  }\n  inpCompanyChange = event => {\n    this.setState({ company: event.target.value })\n  }\n\n  // 輸入欄頭像按下後的function   // no-db\n  avatarIconClick = event => {\n    switch (event.target.id) {\n      case 'aIcon1':\n        this.setState({\n          aIcon: {\n            aIcon1Real: true,\n            aIcon2Real: false,\n            aIcon3Real: false,\n            aIcon4Real: false,\n            aIcon5Real: false,\n          },\n        })\n        break\n      case 'aIcon2':\n        this.setState({\n          aIcon: {\n            aIcon1Real: false,\n            aIcon2Real: true,\n            aIcon3Real: false,\n            aIcon4Real: false,\n            aIcon5Real: false,\n          },\n        })\n        break\n      case 'aIcon3':\n        this.setState({\n          aIcon: {\n            aIcon1Real: false,\n            aIcon2Real: false,\n            aIcon3Real: true,\n            aIcon4Real: false,\n            aIcon5Real: false,\n          },\n        })\n        break\n      case 'aIcon4':\n        this.setState({\n          aIcon: {\n            aIcon1Real: false,\n            aIcon2Real: false,\n            aIcon3Real: false,\n            aIcon4Real: true,\n            aIcon5Real: false,\n          },\n        })\n        break\n      default:\n        this.setState({\n          aIcon: {\n            aIcon1Real: false,\n            aIcon2Real: false,\n            aIcon3Real: false,\n            aIcon4Real: false,\n            aIcon5Real: true,\n          },\n        })\n    }\n  }\n\n  // 輸入欄送出按鈕滑鼠移入 no-db\n  ButtonMouseOver = () => {\n    document.querySelector('#messageInputButton').className =\n      'messageInputButtonOver'\n  }\n  // 輸入欄送出按鈕滑鼠移開 no-db\n  ButtonMouseOut = () => {\n    document.querySelector('#messageInputButton').className =\n      'messageInputButtonOut'\n  }\n\n  // 留言新增 db完成\n  ButtonClick = () => {\n    let messageInput = document.getElementById('messageInput')\n    let name = document.getElementById('inpName').value\n    let content = document.getElementById('inpContent').value\n    messageInput.classList.remove('show')\n    const newData = {\n      id: 'msg' + +new Date(),\n      name: name.length!==0?name:'神秘客',\n      company: document.getElementById('inpCompany').value,\n      avatar: '',\n      content: content.length!==0?content:'可能鍵盤壞掉...沒打字',\n      awesome: 0,\n      boo: 0,\n      time: String(+new Date()),\n    }\n\n    let stateAvatar = this.state.aIcon\n    stateAvatar.aIcon1Real === true\n      ? (newData.avatar = 'Beard')\n      : stateAvatar.aIcon2Real === true\n      ? (newData.avatar = 'Hair')\n      : stateAvatar.aIcon3Real === true\n      ? (newData.avatar = 'Hairstyle')\n      : stateAvatar.aIcon4Real === true\n      ? (newData.avatar = 'Hairstyle2')\n      : (newData.avatar = 'Moustache')\n    this.props.postMSGAsync(newData)\n\n    document.getElementById('inpContent').value = ''\n  }\n\n  // 子留言新增 db完成\n  feedbackSave = () => {\n    // 回傳是哪篇留言的id\n    let messageId = this.state.monderMessageId\n    //做好要蓋回去child的資料\n    let newChildData = {\n      id: messageId,\n      cId: 'cMsg' + +new Date(),\n      cName: document.getElementById('cInpName').value,\n      cCompany: document.getElementById('cInpCompany').value,\n      cAvatar: '', // 這個下面再處理\n      cContent: document.getElementById('feedbackContent').value,\n      cAwesome: 0,\n      cBoo: 0,\n      cTime: +new Date(),\n    }\n\n    // 處理頭像\n    let stateAvatar = this.state.aIcon\n    stateAvatar.aIcon1Real === true\n      ? (newChildData.cAvatar = 'Beard')\n      : stateAvatar.aIcon2Real === true\n      ? (newChildData.cAvatar = 'Hair')\n      : stateAvatar.aIcon3Real === true\n      ? (newChildData.cAvatar = 'Hairstyle')\n      : stateAvatar.aIcon4Real === true\n      ? (newChildData.cAvatar = 'Hairstyle2')\n      : (newChildData.cAvatar = 'Moustache')\n\n    // 從redux調出母留言的完整資料\n\n    this.props.postCMSGAsync(newChildData)\n    this.ModalhandleClose()\n  }\n\n  mobileButtonClick = () => {\n    let mobileButton = document.getElementById('mobileButton')\n    let messageInput = document.getElementById('messageInput')\n    let textback = document.getElementById('textback')\n    let goback = document.getElementById('goback')\n    mobileButton.classList.toggle('red')\n    messageInput.classList.toggle('show')\n    goback.classList.toggle('show')\n    textback.classList.toggle('hide')\n  }\n  render() {\n    return (\n      <>\n        <div id=\"gearBox\" className=\"gearBox\">\n          <i className=\"gearIcon fas fa-cog\" />\n        </div>\n        <div id=\"mobileButton\" className=\"mobileButton\" onClick={this.mobileButtonClick}>\n          <p id=\"textback\" className=\"textback\">我要留言</p><div id=\"goback\" className=\"goback\"><i className=\"fas fa-times\"></i></div>\n        </div>\n        <main className=\"Learn2Container\">\n          {/* 留言顯示區 */}\n          <div id=\"messageView\" className=\"messageView\">\n            {/* 各別留言 */}\n            {this.props.msgs !== undefined ? (\n              this.props.msgs.map(el => (\n                <MessageBox\n                  id={el.id}\n                  key={el.id}\n                  name={el.name}\n                  company={el.company}\n                  avatar={el.avatar}\n                  content={el.content}\n                  awesome={el.awesome}\n                  boo={el.boo}\n                  time={el.time}\n                  feedbackClick={this.ModalhandleShow}\n                  feedbackClose={this.ModalhandleClose}\n                />\n              ))\n            ) : (\n              <div>現在沒有留言啊啊啊啊～快留！！</div>\n            )}\n          </div>\n\n          {/* 右側留言輸入區 */}\n          <div id=\"messageInput\" className=\"messageInput\">\n            <h3 className=\"ff1 fc1\">留言版</h3>\n            <p className=\"ff1 fc3\">\n              我相信空杯是進步最重要的心態之一，我也正努力保持著，若對這些作品有任何想法，\b請盡量給予建議，大感謝～\n            </p>\n            <p className=\"ff1 fc3\">\n              此頁為實作Redux的頁面，所有更新項目皆串連到Redux的Store來改變渲染，雖然在資策會的大專題中已做過留言功能，但當初時間太趕捨棄很多東西，因此這次希望能寫出更完整有趣的留言板。\n            </p>\n            <small>\n              另外為了有無限的正能量（或負能量XD）按讚跟噓特地寫成可以無限按，如果想看一般不可重覆按讚的功能，可去作品頁資策會大專題裡我有寫。\n            </small>\n            {/*資訊輸入區 */}\n            <label htmlFor=\"inpName\" className=\"textMarginTop fc3\">\n              Name\n            </label>\n            <input\n              id=\"inpName\"\n              placeholder=\"請輸入姓名\"\n              value={this.state.name}\n              onChange={this.inpNameChange}\n            />\n            <label htmlFor=\"inpCompany\" className=\"textMarginTop fc3\">\n              公司名\n            </label>\n            <div>\n              <input\n                id=\"inpCompany\"\n                placeholder=\"請輸入公司名\"\n                value={this.state.company}\n                onChange={this.inpCompanyChange}\n              />\n              <small className=\"campanySmallText\">可不填</small>\n            </div>\n            {/* 頭像選擇區 */}\n            <label className=\"textMarginTop fc3\">頭像</label>\n            <AvatarInput\n              state={this.state}\n              avatarIconMouseOver={this.avatarIconMouseOver}\n              avatarIconMouseOut={this.avatarIconMouseOut}\n              avatarIconClick={this.avatarIconClick}\n            />\n            {/* 內容跟送出按鈕 */}\n            <label htmlFor=\"inpContent\" className=\"textMarginTop fc3\">\n              留言內容\n            </label>\n            <textarea id=\"inpContent\" placeholder=\"請輸入留言內容\" />\n            {this.props.msgs[0]!==undefined ? (\n              <Link smooth to={'/message/path#' + 'box'+this.props.msgs[0].id}>\n                <button\n                  id=\"messageInputButton\"\n                  className=\"messageInputButtonOut\"\n                  onMouseOver={this.ButtonMouseOver}\n                  onMouseOut={this.ButtonMouseOut}\n                  onClick={this.ButtonClick}\n                >\n                  Send\n                </button>\n              </Link>\n            ) : (\n              ''\n            )}\n          </div>\n        </main>\n\n        {/* 彈出視窗 */}\n        <Modal\n          size=\"lg\"\n          show={this.state.show}\n          onHide={this.feedbackClose}\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header closeButton className=\"bg-light border-0\">\n            <div className=\"feebackMessageInput\">\n              <label htmlFor=\"cInpName\" className=\"textMarginTop fc3\">\n                Name\n              </label>\n              <input\n                id=\"cInpName\"\n                placeholder=\"請輸入姓名\"\n                value={this.state.name}\n                onChange={this.inpNameChange}\n              />\n              <label htmlFor=\"cInpCompany\" className=\"textMarginTop fc3\">\n                公司名\n              </label>\n              <div>\n                <input\n                  id=\"cInpCompany\"\n                  placeholder=\"請輸入公司名\"\n                  value={this.state.company}\n                  onChange={this.inpCompanyChange}\n                />\n                <small className=\"campanySmallText\">可不填</small>\n              </div>\n              <label className=\"textMarginTop fc3\">頭像</label>\n              <AvatarInputFeedback\n                state={this.state}\n                avatarIconMouseOver={this.avatarIconMouseOver}\n                avatarIconMouseOut={this.avatarIconMouseOut}\n                avatarIconClick={this.avatarIconClick}\n              />\n            </div>\n          </Modal.Header>\n          <Modal.Body className=\"bg-dark\">\n            <div className=\"feebackMessageInput\">\n              <div className=\"border-bottom border-light\">\n                <h4 className=\"text-light\">回覆內容</h4>\n              </div>\n              <textarea id=\"feedbackContent\" />\n            </div>\n          </Modal.Body>\n          <Modal.Footer className=\"bg-dark border-0 justify-content-center\">\n            <Button variant=\"warning\" onClick={this.feedbackClose}>\n              離開\n            </Button>\n            {/* 按鈕 */}\n            <Button type=\"submit\" variant=\"info\" onClick={this.feedbackSave}>\n              儲存\n            </Button>\n          </Modal.Footer>\n        </Modal>\n      </>\n    )\n  }\n}\n\n// 綁定 redux store\n// 綁定 props.msgs <=> store.msgs\n// 我們想要呼叫redux的store可以直接props   前提是先綁定\n// 所以這邊這樣綁就可以直接props.msgs就抓到裡面的資料了\nconst mapStateToProps = store => ({ msgs: store.msgs, cmsgs: store.cmsgs })\n\n// 綁定 redux dispatch\n// 你要用這個action就是要dispatch\n// 範例：store.dispatch(postMSGAsync())\n// 這邊是引入多個所以用bindActionCreators包一起\n// 然後引入action要用props所以用mapStateToProps這個\n// 第3種，: redux(state)綁定到此元件的props、部份綁定action creator\n// 這個action creator就是上面引入的那個\nconst mapDispatchToProps = dispatch =>\n  bindActionCreators(\n    { postMSG, putMSG, delMSG, postCMSG, postCMSGAsync, postMSGAsync },\n    dispatch\n  )\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Message)\n"]},"metadata":{},"sourceType":"module"}